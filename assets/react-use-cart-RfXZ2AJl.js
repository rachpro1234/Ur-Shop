import{r as E}from"./react-328yWDDP.js";function o(){return o=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])}return r},o.apply(this,arguments)}function Q(r,t){var a=E.useState(function(){try{var l=typeof window<"u"&&window.localStorage.getItem(r);return l||t}catch{return t}}),n=a[0],m=a[1],d=function(f){try{var s=f instanceof Function?f(n):f;m(s),window.localStorage.setItem(r,s)}catch(v){console.log(v)}};return[n,d]}var y={items:[],isEmpty:!0,totalItems:0,totalUniqueItems:0,cartTotal:0,metadata:{}},R=E.createContext(y),F=function(t){return t===void 0&&(t=12),[].concat(Array(t)).map(function(){return(~~(Math.random()*36)).toString(36)}).join("")},X=function(){var t=E.useContext(R);if(!t)throw new Error("Expected to be wrapped in a CartProvider");return t};function z(r,t){switch(t.type){case"SET_ITEMS":return M(r,t.payload);case"ADD_ITEM":{var a=[].concat(r.items,[t.payload]);return M(r,a)}case"UPDATE_ITEM":{var n=r.items.map(function(d){return d.id!==t.id?d:o({},d,t.payload)});return M(r,n)}case"REMOVE_ITEM":{var m=r.items.filter(function(d){return d.id!==t.id});return M(r,m)}case"EMPTY_CART":return y;case"CLEAR_CART_META":return o({},r,{metadata:{}});case"SET_CART_META":return o({},r,{metadata:o({},t.payload)});case"UPDATE_CART_META":return o({},r,{metadata:o({},r.metadata,t.payload)});default:throw new Error("No action specified")}}var M=function(t,a){t===void 0&&(t=y);var n=K(a),m=n===0;return o({},y,t,{items:B(a),totalItems:H(a),totalUniqueItems:n,cartTotal:G(a),isEmpty:m})},B=function(t){return t.map(function(a){return o({},a,{itemTotal:a.price*a.quantity})})},G=function(t){return t.reduce(function(a,n){return a+n.quantity*n.price},0)},H=function(t){return t.reduce(function(a,n){return a+n.quantity},0)},K=function(t){return t.length},Z=function(t){var a=t.children,n=t.id,m=t.defaultItems,d=m===void 0?[]:m,l=t.onSetItems,f=t.onItemAdd,s=t.onItemUpdate,v=t.onItemRemove,A=t.storage,h=A===void 0?Q:A,P=t.metadata,g=n||F(),_=h(n?"react-use-cart-"+g:"react-use-cart",JSON.stringify(o({id:g},y,{items:d,metadata:P}))),U=_[0],w=_[1],S=E.useReducer(z,JSON.parse(U)),p=S[0],i=S[1];E.useEffect(function(){w(JSON.stringify(p))},[p,w]);var D=function(e){i({type:"SET_ITEMS",payload:e.map(function(u){return o({},u,{quantity:u.quantity||1})})}),l&&l(e)},O=function(e,u){if(u===void 0&&(u=1),!e.id)throw new Error("You must provide an `id` for items");if(!(u<=0)){var I=p.items.find(function(L){return L.id===e.id});if(!I&&!e.hasOwnProperty("price"))throw new Error("You must pass a `price` for new items");if(!I){var T=o({},e,{quantity:u});i({type:"ADD_ITEM",payload:T}),f&&f(T);return}var C=o({},e,{quantity:I.quantity+u});i({type:"UPDATE_ITEM",id:e.id,payload:C}),s&&s(C)}},q=function(e,u){!e||!u||(i({type:"UPDATE_ITEM",id:e,payload:u}),s&&s(u))},x=function(e,u){if(u<=0){v&&v(e),i({type:"REMOVE_ITEM",id:e});return}var I=p.items.find(function(C){return C.id===e});if(!I)throw new Error("No such item to update");var T=o({},I,{quantity:u});i({type:"UPDATE_ITEM",id:e,payload:T}),s&&s(T)},V=function(e){e&&(i({type:"REMOVE_ITEM",id:e}),v&&v(e))},N=function(){return i({type:"EMPTY_CART"})},Y=function(e){return p.items.find(function(u){return u.id===e})},$=function(e){return p.items.some(function(u){return u.id===e})},b=function(){i({type:"CLEAR_CART_META"})},j=function(e){e&&i({type:"SET_CART_META",payload:e})},J=function(e){e&&i({type:"UPDATE_CART_META",payload:e})};return E.createElement(R.Provider,{value:o({},p,{getItem:Y,inCart:$,setItems:D,addItem:O,updateItem:q,updateItemQuantity:x,removeItem:V,emptyCart:N,clearCartMetadata:b,setCartMetadata:j,updateCartMetadata:J})},a)};export{Z as C,X as u};
